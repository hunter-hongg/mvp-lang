# MVP v0.0.1 "Genesis"

> **First Breath.**
> The first usable version of MVP. Explicit. Safe. Predictable.

---

## ğŸ‰ Release Highlights

This is the **first usable milestone** for the MVP language.

- âœ… **Compilation Pipeline**: Fully supports **compiling to C++** backend.
- âœ… **Core Safety**: Basic **Ownership Model** implemented and enforced at compile time.

---

## ğŸš€ Features

### 1. Variable Declaration

MVP adopts a unified declaration syntax, defaults to immutability, and follows RAII semantics.
**Syntax Example:**

```mvp
x := 42          // Immutable binding (Type inferred)
mut y := [1, 2]  // Mutable binding
```

**Rules:**

- **Unified Operator**: Only `:=` is used for declaration.
- **Immutable by Default**: Requires explicit `mut` keyword for modification.
- **Auto Destruction**: Destructors are called automatically at the end of the scope (RAII).

---

### 2. Ownership Operations

Explicit memory management, rejecting implicit copies.
| Operation | Syntax | Semantics |
| :--- | :--- | :--- |
| **Ownership Transfer** | `move x` | Relinquishes ownership of `x`; `x` becomes invalid immediately. |
| **Deep Copy** | `clone x` | Creates a semantically correct copy of `x`; `x` remains valid. |
**Code Example:**

```mvp
a := [1, 2, 3]
b := move a    // Ownership of 'a' moves to 'b', 'a' is now invalid.
c := clone b   // 'b' is still valid; 'c' is an independent deep copy.
```

**Assignment Rules:**

- **Copy Types** (e.g., `int`, `bool`, pure value `struct`):
  - âœ… Implicit copy allowed: `y := x`
- **Non-Copy Types** (e.g., `[T]`, `string`):
  - âŒ Implicit copy forbidden: `y := x` (Compile Error)
  - âœ… Explicit operation required: `y := move x` or `y := clone x`

---

### 3. Copy Type Inference

The compiler statically analyzes whether a type is Copy during the AST stage; users cannot override this.
**Inference Rules:**

- **Is Copy**:
  - Built-in primitives: `int`, `bool`, `float32`, `float64`, `char`
  - `struct` where all fields are recursively Copy
- **Is Not Copy**:
  - Dynamic arrays `[T]`
  - Strings `string`
  - Structs containing system resources (e.g., file handles)

---

### 4. Function Definition

**Syntax Example:**

```mvp
add = (a: int, b: int): int => a + b
greet = (ref name: string): void => {
    // Multi-statement body
    print("Hello, ", name)
}
```

**Rules:**

- **First-Class Values**: Functions can be assigned, passed, and returned.
- **Single Expression**: Omit `{}` and `return`.
- **Multi-Statement**: The last expression is returned automatically; use `return expr` for early exit.
- **Return Type**: Inference is not supported yet; must be explicitly annotated with `: type` after parameters.

---

### 5. Parameter Passing

Function parameter passing semantics are explicit and unambiguous.
| Syntax | Semantics | Call Site |
| :--- | :--- | :--- |
| `ref x: T` | Read-only Borrow | `f(arg)` |
| `x: T` | Ownership Takeover | `f(move arg)` |
**Code Example:**

```mvp
// Borrow: mark with 'ref'
hash = (ref data: [byte]): int => { ... }
// Ownership: unmarked (default)
save = (f: File): void => { ... }
main = (): int => {
    buf := [1, 2]
    file := open_file()
    h := hash(buf)        // âœ… Borrow, 'buf' is still valid
    save(move file)       // âœ… Transfer, 'file' is now invalid
}
```

**Restrictions:**

- âŒ Implicit copying of non-Copy parameters is forbidden (e.g., `(x: [int])` will error).
- âŒ Mutable borrows (`mut ref`) are not supported in v0.0.1.

---

### 6. Built-in Types (v0.0.1)

| Type      | Description                                           |
| :-------- | :---------------------------------------------------- |
| `int`     | 64-bit signed integer (platform independent)          |
| `bool`    | `true` / `false`                                      |
| `float32` | 32-bit IEEE 754 floating point                        |
| `float64` | 64-bit IEEE 754 floating point                        |
| `char`    | Unicode scalar value (U+0000â€“U+D7FF, U+E000â€“U+10FFFF) |
| `[T]`     | Dynamic array (heap allocated, Non-Copy)              |
| `string`  | UTF-8 encoded string (Non-Copy)                       |
| `struct`  | User-defined structure                                |

---

### 7. Control Flow (v0.0.1)

Support for basic control structures:

- `if condition { ... } else { ... }`
- `return expr` (for early exit)
  > All control structures are expressions (to be expanded in future versions).

---

### 8. Memory Safety Guarantees

MVP provides the following safety guarantees at compile time:

- âœ… No raw pointers, no manual memory management.
- âœ… Compile-time tracking of variable state: `valid` / `moved`.
- âœ… Usage of `moved` variables is forbidden (Compile Error).
- âœ… `move` is forbidden while borrowed (Compile Error).
- âœ… Implicit copying of Non-Copy types is forbidden.

---

### 9. Lexical Convention: Statement Termination

MVP source code does **not use semicolons** as statement terminators.
**Automatic Termination Rules:**

- Statements terminate automatically at a newline, provided the current syntax structure is complete.
- The compiler determines line continuation based on context (similar to Go's ASI rules): - **Continue**: Line ends with an operator (e.g., `+`, `=`, `=>`, `(`, `[`, `{`, `,`). - **Terminate**: Next line starts with a distinct statement (e.g., `if`, `for`, `IDENT :=`, `}`).
  **Error Handling:**
- Semicolons are treated as illegal tokens during lexical analysis; usage reports a `syntax error`.
  > This design ensures syntax remains concise, unambiguous, and naturally compatible with expression-oriented style.

---

## ğŸ› ï¸ Compiler

- **Target**: C++ (Readable C++ code generation)
- **Safety**: Compile-time Ownership Verification
