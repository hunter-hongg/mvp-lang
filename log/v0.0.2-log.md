# MVP Language â€“ v0.0.2 "Import"

> **Hello, Modular World.**

> Building on the safety foundation of v0.0.1, introducing **modularity**, **control flow**, and **developer experience improvements**.

---

## ğŸ“‹ Version Information

| Item | Value |
|------|-------|
| **Version** | v0.0.2 |
| **Codename** | "Import" |
| **Release Date** | February 18, 2026 |
| **License** | MIT |
| **Repository** | [mvp-lang](https://github.com/hunter-hongg/mvp-lang) |

---

## ğŸš€ New Features Overview

| # | Feature | Category | Status |
|---|---------|----------|--------|
| 1 | Toolchain Unification (`mvp` command + `mvp.toml`) | Tool | âœ… New |
| 2 | `choose` Match Statement | Control Flow | âœ… New |
| 3 | `if` Internal `move` Analysis (Pessimistic Merge) | Ownership | âœ… New |
| 4 | Basic Modularity (`import`/`export`) | Module | âœ… New |
| 5 | Struct Initialization Syntax Change | Syntax | âš ï¸ Changed |
| 6 | Automatic `return` | Experience | âœ… Improved |
| 7 | `main` Function Simplification | Experience | âœ… Improved |
| 8 | Basic Built-in Functions | Standard Library | âœ… New |

---

## ğŸ“¦ Detailed Description

### 1. Toolchain Unification

```bash
mvp init <project>     # Initialize project, generate mvp.toml
mvp build              # Build project
mvp run                # Build and run
mvp clean              # Clean build cache
```

- Uses `cmdliner` as command-line parsing library
- Supports `mvp.toml` project configuration and dependency management
- Automatically resolves dependencies and builds

**mvp.toml Example:**

```toml
[project]
name = "myproject"
type = "bin"
```

---

### 2. `choose` Match Statement

```mvp
choose (x) {
  when (case1) {
    // ...
  }
  when (case2) {
    // ...
  }
  otherwise {
    // ...
  }
}
```

| Feature | Description |
|---------|-------------|
| Syntax | `choose (expression)` + `when (condition)` |
| Compilation Behavior | Expands to C-style `if-else` |
| Guard | âŒ Not supported yet (e.g., `when (x > 0)`) |
| Expression Mode | âŒ Not supported as expression yet |

> âš ï¸ **Note**: Expressions after `choose` and `when` **must be wrapped in parentheses**

---

### 3. `if` Internal `move` Analysis (Pessimistic Merge)

If **any branch** performs `move` on a variable, the variable is **globally considered `moved`** after the `if` block:

```mvp
if cond {
  move buf  // buf moved in true branch
} else {
  // nothing
}
// âŒ Compile error: buf may be moved
```

> **Design Philosophy**: v0.0.2 prioritizes safety; path-sensitive analysis will be introduced in future versions.

---

### 4. Basic Modularity (File as Module)

#### Design Principles

- Each `.mvp` file = one independent module
- Symbols inside module are **private by default**, must be explicitly `export`ed

#### Export

```mvp
module "example.foo"  // Must declare module name at file start

foo = (): int => 2  // Private
export foo          // Public
```

#### Import

```mvp
import "std/math"        // Import std/math.mvp
result := std.math.sqrt(4)

import "utils/io" as io  // Specify alias
io.println("Hello")
```

#### Known Limitations

- âŒ Circular dependency detection will be added in v0.0.3
- âš ï¸ Users must avoid circular imports manually

---

### 5. Struct Initialization Syntax Change âš ï¸

```mvp
// âŒ v0.0.1 style (no longer supported)
Point { x = 1, y = 2 }

// âœ… v0.0.2 style (requires struct keyword)
struct Point { x = 1, y = 2 }

// âœ… Cross-module struct
struct helper.Point { x = 1, y = 2 }
```

| Change | Description |
|--------|-------------|
| Old Syntax | `StructName { ... }` |
| New Syntax | `struct StructName { ... }` |
| Reason | Avoid ambiguity with field access (is `a.b.c` a module path or field?) |
| Impact | âš ï¸ Breaking Change, v0.0.1 code needs migration |

---

### 6. Automatic `return`

- **Single expression function** â†’ automatically returns
- **Multi-statement block** â†’ last expression statement automatically becomes return value

```mvp
add = (a: int, b: int): int => a + b  // Single expression

greet = (name: string): string => {
  msg := "Hello, " + name + "!"
  msg  // Automatic return
}
```

---

### 7. `main` Function Simplification

User only needs to write:

```mvp
main = () => {
  println("Run!")
}
```

Compiler automatically:

1. Renames user `main` to `mvp_main`
2. Generates C entry point:
    
    ```c
    int main() {
        mvp_main();
        return 0;
    }
    ```

> âœ… Users no longer write `: int` or `return 0`, focus on logic itself

---

### 8. Basic Built-in Functions

```mvp
main = () => {
  println("Hello from MVP!")  // âœ… Built-in, no import needed
  printlns("Formatted: ", 42) // âœ… Built-in, no import needed
}
```

| Feature | Description |
|---------|-------------|
| Implementation | **header-only library** (binds to libc) |
| Visibility | **Automatically visible**, no `import` needed |
| Common Functions | `println`, `printf`, `malloc`, `exit`, etc. |
| Extension | Users can import more standard library modules |

> âœ… Common functions out of the box, advanced features on demand

---

## âš ï¸ Known Limitations

| Limitation | Planned Version |
|------------|-----------------|
| Circular Dependency Detection | v0.0.3 |
| `choose` Guard | v0.0.3 |
| `choose` Expression Mode | v0.1.0 |
| Path-Sensitive move Analysis | v0.1.0 |
| Centralized Package Registry | v1.0.0 |

---

## ğŸ”„ Migration Guide (v0.0.1 â†’ v0.0.2)

| v0.0.1 | v0.0.2 |
|--------|--------|
| `Point { x = 1 }` | `struct Point { x = 1 }` |
| **N/A** | `choose (x) {` |
| **N/A** | `when (x) {` |
| `mvp <file>` | `mvp sin-build <file>` |
| **N/A** | `mvp run` |

---

## ğŸ“¥ Quick Start

```bash
# Install
git clone https://github.com/hunter-hongg/mvp-lang
cd mvp
dune build
# Manual install, or download directly from GitHub Releases

# Initialize project
mkdir hello
cd hello
mvp init hello --type=bin

# Write code
# Edit main.mvp

# Run
mvp run
```

---

## ğŸ§§ Version History

| Version | Date | Milestone |
|---------|------|-----------|
| v0.0.1 | 2026-02-14 | Basic Compiler + Ownership Model |
| **v0.0.2** | **2026-02-18** | **Modularity + Control Flow** |
| v0.0.3 | 2026-03-22 | Circular Dependency Detection + Guard |
| v0.1.0 | 2026-06-?? | Generics + enum |

---

## â¤ï¸ MVP's Evolution Philosophy

> **Add sweetness on top of safety,**  
> **Seek simplicity within explicitness,**  
> **Make every line of code trustworthy,**  
> **Make every module boundary clear.**

---

## ğŸ™ Acknowledgments

Thank you to every developer who uses, tests, and provides feedback on MVP.

---

#lang/mvp #design/module
